# pnpm 入门

## yarn 和 npm 的痛点

参考： [pnpm 是凭什么对 npm 和 yarn 降维打击的](https://juejin.cn/post/7127295203177676837)

1. 幽灵依赖

   yarn 通过扁平化来管理依赖，也就是会把依赖的依赖提升到 node_modules 的外层。

   那么就会出现幽灵依赖，也就是说如果你直接引入了一个 `express` 包，而这个包是别的依赖包引入的，你的代码中也就不用安装这个依赖就能直接 import 并且运行。一旦别人的依赖发生变化，也就是初始化的使用不会安装 `express` 包，那么你的代码就可能出现错误。

2. 不同版本的依赖提升问题

   如果依赖出现不同版本的包，那么只有一个版本的包会被提升。如果后面遇到了不同版本的依赖还是会出现依赖嵌套的问题。

   > 依赖嵌套可能在 window 出现路径无法找到的问题，因为 windows 规定文件路径最长是260多个字符

3. 依赖拷贝问题

   也就是说每一次的依赖都是会重新拷贝的

## pnpm 解决了什么

采用了集中式的 store 来存储依赖，扁平的分布。

依赖之间采用软连接的方式连接。

### 删除依赖怎么做呢

如果项目中不再使用某个依赖，那么它的幽灵依赖该怎么删除呢？

pnpm 提供了一个命令

```bash
$ pnpm store prune
```

